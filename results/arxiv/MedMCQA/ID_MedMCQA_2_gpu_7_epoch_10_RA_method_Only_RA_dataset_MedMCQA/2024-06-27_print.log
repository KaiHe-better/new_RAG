2024-06-27 13:36:42,536 **************** Configuration **************** 
2024-06-27 13:36:42,537 gpu: 7
2024-06-27 13:36:42,537 test_code_flag: False
2024-06-27 13:36:42,537 ID: MedMCQA_2
2024-06-27 13:36:42,537 seed: 42
2024-06-27 13:36:42,537 num_workers: 48
2024-06-27 13:36:42,537 loading_ckpt_path: None
2024-06-27 13:36:42,537 RA_method: Only_RA
2024-06-27 13:36:42,537 LLM: meta-llama/Meta-Llama-3-8B-Instruct
2024-06-27 13:36:42,537 dataset: MedMCQA
2024-06-27 13:36:42,537 train_batch_size: 2
2024-06-27 13:36:42,537 test_batch_size: 2
2024-06-27 13:36:42,537 accumulation_steps: 1
2024-06-27 13:36:42,537 demonstration: False
2024-06-27 13:36:42,537 demons_cnt: 1
2024-06-27 13:36:42,537 l2_coef: 0
2024-06-27 13:36:42,537 train_eval: 500
2024-06-27 13:36:42,537 epoch: 10
2024-06-27 13:36:42,537 gate_weight: 2
2024-06-27 13:36:42,537 lr: 0.0001
2024-06-27 13:36:42,537 init_lr_num: 500
2024-06-27 13:36:42,538 lr_decay: 0.9
2024-06-27 13:36:42,538 lr_decay_interval: 400
2024-06-27 13:36:42,538 num_layers: 1
2024-06-27 13:36:42,538 d_model: 768
2024-06-27 13:36:42,538 dim_feedforward: 2048
2024-06-27 13:36:42,538 layer_norm_eps: 1e-05
2024-06-27 13:36:42,538 nhead: 8
2024-06-27 13:36:42,538 dropout: 0.1
2024-06-27 13:36:42,538 loss_list: kl_soft+kl_hard
2024-06-27 13:36:42,538 len_penalty_weight: 10
2024-06-27 13:36:42,538 soft_weight: 1
2024-06-27 13:36:42,538 hard_weight: 1
2024-06-27 13:36:42,538 do_sample: True
2024-06-27 13:36:42,538 temperature: 1e-09
2024-06-27 13:36:42,538 top_p: 0
2024-06-27 13:36:42,538 max_new_tokens: 1
2024-06-27 13:36:42,538 infer_add_gold_retrieval: False
2024-06-27 13:36:42,538 multi_query: False
2024-06-27 13:36:42,538 rewrite_num: 1
2024-06-27 13:36:42,538 chunk_size: 512
2024-06-27 13:36:42,538 chunk_overlap: 20
2024-06-27 13:36:42,538 if_hierarchical_retrieval: True
2024-06-27 13:36:42,538 hierarchical_ratio: 1.4
2024-06-27 13:36:42,538 quantile_num: 0.99
2024-06-27 13:36:42,538 n_docs: 10
2024-06-27 13:36:42,538 model_name_or_path: facebook/contriever-msmarco
2024-06-27 13:36:42,539 question_maxlength: 512
2024-06-27 13:36:42,539 passages: datasets/Retrieval_corpus/enwiki_2020_dec_intro_only.jsonl
2024-06-27 13:36:42,539 passages_embeddings: datasets/Retrieval_corpus/enwiki_dec_2020_contriever_intro/*
2024-06-27 13:36:42,539 lowercase: False
2024-06-27 13:36:42,539 normalize_text: False
2024-06-27 13:36:42,539 save_or_load_index: False
2024-06-27 13:36:42,539 no_fp16: True
2024-06-27 13:36:42,539 projection_size: 768
2024-06-27 13:36:42,539 n_subquantizers: 0
2024-06-27 13:36:42,539 n_bits: 8
2024-06-27 13:36:42,539 indexing_batch_size: 30000000
2024-06-27 13:36:42,539 device: cuda
2024-06-27 13:36:42,539 prompt_file: prompts/MedMCQA.json
2024-06-27 13:36:42,539 dir_path: ./results/output/ID_MedMCQA_2_gpu_7_epoch_10_RA_method_Only_RA_dataset_MedMCQA
2024-06-27 13:36:42,539 print_logger: <Logger print (DEBUG)>
2024-06-27 13:36:42,539 **************** Configuration **************** 


2024-06-27 13:36:42,539 Loading retriever ...
2024-06-27 13:37:34,806 Loading meta-llama/Meta-Llama-3-8B-Instruct in torch.bfloat16...
2024-06-27 13:37:41,879 Finish loading in 0.12 mins.
2024-06-27 13:37:42,784 Loading data ...
2024-06-27 13:37:42,893 prompt_format: retrieve-prompt 

2024-06-27 13:37:42,894 
 Start test ...  
2024-06-27 13:37:54,306 testing process num: 0
2024-06-27 13:39:18,132 testing process num: 200
2024-06-27 13:40:42,822 testing process num: 400
2024-06-27 13:42:07,521 testing process num: 600
2024-06-27 13:43:32,856 testing process num: 800
2024-06-27 13:44:57,561 testing process num: 1000
2024-06-27 13:46:21,921 testing process num: 1200
2024-06-27 13:47:47,912 testing process num: 1400
2024-06-27 13:49:11,831 testing process num: 1600
2024-06-27 13:50:37,393 testing process num: 1800
2024-06-27 13:52:02,912 testing process num: 2000
2024-06-27 13:52:42,412 test: acc 43.56, f1 36.04, precision 37.9, recall 64.08, old_doc_len:0.0, new_doc_len:0.0, hallucination: 0.5 
2024-06-27 13:52:42,412 cost_time: 14.991968929767609  
 
