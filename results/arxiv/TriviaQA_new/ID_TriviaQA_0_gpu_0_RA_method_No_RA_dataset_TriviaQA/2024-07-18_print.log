2024-07-18 10:19:48,754 **************** Configuration **************** 
2024-07-18 10:19:48,754 gpu: 0
2024-07-18 10:19:48,755 test_code_flag: False
2024-07-18 10:19:48,755 ID: TriviaQA_0
2024-07-18 10:19:48,755 seed: 42
2024-07-18 10:19:48,755 num_workers: 48
2024-07-18 10:19:48,755 loading_ckpt_path: None
2024-07-18 10:19:48,755 RA_method: No_RA
2024-07-18 10:19:48,755 LLM: meta-llama/Meta-Llama-3-8B-Instruct
2024-07-18 10:19:48,755 dataset: TriviaQA
2024-07-18 10:19:48,755 train_batch_size: 8
2024-07-18 10:19:48,755 test_batch_size: 8
2024-07-18 10:19:48,755 accumulation_steps: 1
2024-07-18 10:19:48,756 demonstration: False
2024-07-18 10:19:48,756 demons_cnt: 1
2024-07-18 10:19:48,756 l2_coef: 0
2024-07-18 10:19:48,756 train_eval: 500
2024-07-18 10:19:48,756 total_step: 25000
2024-07-18 10:19:48,756 gate_weight_0: 1
2024-07-18 10:19:48,756 gate_weight_1: 2
2024-07-18 10:19:48,756 lr: 0.0001
2024-07-18 10:19:48,756 init_lr_num: 500
2024-07-18 10:19:48,756 lr_decay: 0.9
2024-07-18 10:19:48,756 lr_decay_interval: 400
2024-07-18 10:19:48,756 num_layers: 1
2024-07-18 10:19:48,756 d_model: 768
2024-07-18 10:19:48,757 dim_feedforward: 2048
2024-07-18 10:19:48,757 layer_norm_eps: 1e-05
2024-07-18 10:19:48,757 nhead: 8
2024-07-18 10:19:48,757 dropout: 0.1
2024-07-18 10:19:48,757 loss_list: kl_soft+kl_hard
2024-07-18 10:19:48,757 len_penalty_weight: 10
2024-07-18 10:19:48,757 soft_weight: 1
2024-07-18 10:19:48,757 hard_weight: 1
2024-07-18 10:19:48,757 do_sample: True
2024-07-18 10:19:48,757 temperature: 1e-09
2024-07-18 10:19:48,757 top_p: 0
2024-07-18 10:19:48,757 max_new_tokens: 40
2024-07-18 10:19:48,757 infer_add_gold_retrieval: False
2024-07-18 10:19:48,757 multi_query: False
2024-07-18 10:19:48,758 rewrite_num: 1
2024-07-18 10:19:48,758 chunk_size: 512
2024-07-18 10:19:48,758 chunk_overlap: 20
2024-07-18 10:19:48,758 if_hierarchical_retrieval: True
2024-07-18 10:19:48,758 hierarchical_ratio: 1.4
2024-07-18 10:19:48,758 quantile_num: 1
2024-07-18 10:19:48,758 n_docs: 10
2024-07-18 10:19:48,758 model_name_or_path: facebook/contriever-msmarco
2024-07-18 10:19:48,758 question_maxlength: 512
2024-07-18 10:19:48,758 passages: datasets/Retrieval_corpus/enwiki_2020_dec_intro_only.jsonl
2024-07-18 10:19:48,758 passages_embeddings: datasets/Retrieval_corpus/enwiki_dec_2020_contriever_intro/*
2024-07-18 10:19:48,758 lowercase: False
2024-07-18 10:19:48,758 normalize_text: False
2024-07-18 10:19:48,758 save_or_load_index: False
2024-07-18 10:19:48,759 no_fp16: True
2024-07-18 10:19:48,759 projection_size: 768
2024-07-18 10:19:48,759 n_subquantizers: 0
2024-07-18 10:19:48,759 n_bits: 8
2024-07-18 10:19:48,759 indexing_batch_size: 30000000
2024-07-18 10:19:48,759 device: cuda
2024-07-18 10:19:48,759 prompt_file: prompts/TriviaQA.json
2024-07-18 10:19:48,759 dir_path: ./results/output/ID_TriviaQA_0_gpu_0_RA_method_No_RA_dataset_TriviaQA
2024-07-18 10:19:48,759 print_logger: <Logger print (DEBUG)>
2024-07-18 10:19:48,759 **************** Configuration **************** 


2024-07-18 10:19:48,759 Loading meta-llama/Meta-Llama-3-8B-Instruct in torch.bfloat16...
2024-07-18 10:19:55,858 Finish loading in 0.12 mins.
2024-07-18 10:19:56,362 Loading data ...
2024-07-18 10:20:40,994 prompt_format: general-prompt 

2024-07-18 10:20:40,994 
 Start test ...  
2024-07-18 10:20:47,215 testing process num: 0
2024-07-18 10:23:28,143 testing process num: 200
2024-07-18 10:26:07,677 testing process num: 400
2024-07-18 10:28:50,717 testing process num: 600
2024-07-18 10:31:33,809 testing process num: 800
2024-07-18 10:34:18,519 testing process num: 1000
2024-07-18 10:36:59,448 testing process num: 1200
2024-07-18 10:39:40,204 testing process num: 1400
2024-07-18 10:39:54,659 test: f1 51.81, EM : 41.8/59.3, old_doc_len:0.0, new_doc_len:0.0
2024-07-18 10:39:54,659 cost_time: 19.227745683987937  
 
2024-07-18 10:39:54,690 Uncaught exception
Traceback (most recent call last):
  File "/hpc/home/kai_he/workshop/My_project/new_RAG/run.py", line 190, in <module>
    main(args)
  File "/hpc/home/kai_he/workshop/My_project/new_RAG/run.py", line 178, in main
    test_performce, all_test_predictions, all_test_input_list, all_test_answers = trainer.test_proc(test_data_loader)
ValueError: too many values to unpack (expected 4)
